create database supplierDB;
use supplierDB;

CREATE TABLE SUPPLIERS (
    SID INT PRIMARY KEY,
    SNAME VARCHAR(50),
    CITY VARCHAR(50)
);

CREATE TABLE PARTS (
    PID INT PRIMARY KEY,
    PNAME VARCHAR(50),
    COLOR VARCHAR(20)
);

CREATE TABLE CATALOG (
    SID INT,
    PID INT,
    COST INT,
    PRIMARY KEY (SID, PID),
    FOREIGN KEY (SID) REFERENCES SUPPLIERS(SID),
    FOREIGN KEY (PID) REFERENCES PARTS(PID)
);


INSERT INTO SUPPLIERS (SID, SNAME, CITY) VALUES
(10001, 'Acme Widget', 'Bangalore'),
(10002, 'Johns', 'Kolkata'),
(10003, 'Vimal', 'Mumbai'),
(10004, 'Reliance', 'Delhi');
SELECT * FROM SUPPLIERS;

INSERT INTO PARTS (PID, PNAME, COLOR) VALUES
(20001, 'Book', 'Red'),
(20002, 'Pen', 'Red'),
(20003, 'Pencil', 'Green'),
(20004, 'Mobile', 'Green'),
(20005, 'Charger', 'Black');
SELECT * FROM PARTS;

INSERT INTO CATALOG (SID, PID, COST) VALUES
(10001, 20001, 10),
(10001, 20002, 10),
(10001, 20003, 30),
(10001, 20004, 10),
(10001, 20005, 40),
(10002, 20001, 20),
(10002, 20003, 30),
(10003, 20003, 30),
(10004, 20003, 40);
SELECT * FROM CATLOG;


SELECT DISTINCT PNAME FROM PARTS
JOIN CATALOG ON PARTS.PID = CATALOG.PID ;

SELECT SNAME FROM SUPPLIERS 
WHERE NOT EXISTS ( 	
	SELECT * FROM PARTS
    WHERE NOT EXISTS(
		SELECT * FROM CATALOG
        WHERE CATALOG.SID = SUPPLIERS.SID 
        AND CATALOG.PID = PARTS.PID));
        

SELECT SNAME FROM SUPPLIERS 
WHERE NOT EXISTS(
		SELECT * FROM PARTS 
        WHERE PARTS.COLOR = "Red"
        AND NOT EXISTS(
			SELECT * FROM CATALOG 
            WHERE CATALOG.SID = SUPPLIERS.SID AND PARTS.PID = CATALOG.PID));
            
SELECT P.PNAME
FROM PARTS P
JOIN CATALOG C ON P.PID = C.PID
JOIN SUPPLIERS S ON C.SID = S.SID
WHERE S.SNAME = 'Acme Widget'
  AND P.PID NOT IN (
    SELECT PID
    FROM CATALOG
    WHERE SID <> (
      SELECT SID FROM SUPPLIERS WHERE SNAME = 'Acme Widget'
    )
  );    